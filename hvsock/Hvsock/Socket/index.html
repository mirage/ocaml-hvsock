<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Socket (hvsock.Hvsock.Socket)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">hvsock</a> &#x00BB; <a href="../index.html">Hvsock</a> &#x00BB; Socket</nav><header class="odoc-preamble"><h1>Module <code><span>Hvsock.Socket</span></code></h1><p>An interface for hypervisor sockets which hides as many of the differences between Linux, Windows and Mac as possible.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec exception" id="exception-Unsupported_platform" class="anchored"><a href="#exception-Unsupported_platform" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Unsupported_platform</span> <span class="keyword">of</span> string</span></code></div><div class="spec-doc"><p>An operation cannot be performed on this platform</p></div></div><div class="odoc-spec"><div class="spec type" id="type-sockaddr" class="anchored"><a href="#type-sockaddr" class="anchor"></a><code><span><span class="keyword">type</span> sockaddr</span></code></div><div class="spec-doc"><p>A socket address which can either be listened on or connected to.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-sockaddr_of_uri" class="anchored"><a href="#val-sockaddr_of_uri" class="anchor"></a><code><span><span class="keyword">val</span> sockaddr_of_uri : <span><span class="xref-unresolved">Uri</span>.t <span class="arrow">&#45;&gt;</span></span> <a href="#type-sockaddr">sockaddr</a></span></code></div><div class="spec-doc"><p>Parse a URI as a socket address. This currently supports</p><ul><li>vsock://:80</li><li>hvsock://&lt;VM GUID&gt;/3049197C-9A4E-4FBF-9367-97F792F16994</li><li>hvsock://&lt;VM name&gt;/3049197C-9A4E-4FBF-9367-97F792F16994</li><li>vsock://2:80/</li><li>hyperkit://:80/Users/foo/Library/Containers/com.docker.docker/Data/vms/0</li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-to_hyperv" class="anchored"><a href="#val-to_hyperv" class="anchor"></a><code><span><span class="keyword">val</span> to_hyperv : <span><a href="#type-sockaddr">sockaddr</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../Af_hyperv/index.html#type-sockaddr">Af_hyperv.sockaddr</a> option</span></span></code></div><div class="spec-doc"><p>Expose the AF_HYPERV socket address, if one exists</p></div></div><div class="odoc-spec"><div class="spec value" id="val-to_vsock" class="anchored"><a href="#val-to_vsock" class="anchor"></a><code><span><span class="keyword">val</span> to_vsock : <span><a href="#type-sockaddr">sockaddr</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../Af_vsock/index.html#type-sockaddr">Af_vsock.sockaddr</a> option</span></span></code></div><div class="spec-doc"><p>Expose the AF_VSOCK socket address, if one exists</p></div></div><div class="odoc-spec"><div class="spec value" id="val-to_hyperkit" class="anchored"><a href="#val-to_hyperkit" class="anchor"></a><code><span><span class="keyword">val</span> to_hyperkit : <span><a href="#type-sockaddr">sockaddr</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../Hyperkit/index.html#type-sockaddr">Hyperkit.sockaddr</a> option</span></span></code></div><div class="spec-doc"><p>Expose the hyperkit socket address, if one exists</p></div></div><div class="odoc-include"><details open="open"><summary class="spec include"><code><span><span class="keyword">include</span> <a href="../Af_common/module-type-S/index.html">Af_common.S</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="../Af_common/module-type-S/index.html#type-sockaddr">sockaddr</a> := <a href="#type-sockaddr">sockaddr</a></span> <span class="keyword">and</span> <span><span class="keyword">type</span> <a href="../Af_common/module-type-S/index.html#type-t">t</a> = <span class="xref-unresolved">Unix</span>.file_descr</span></span></code></summary><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span><span> = <span class="xref-unresolved">Unix</span>.file_descr</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-string_of_sockaddr" class="anchored"><a href="#val-string_of_sockaddr" class="anchor"></a><code><span><span class="keyword">val</span> string_of_sockaddr : <span><a href="#type-sockaddr">sockaddr</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-create" class="anchored"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : <span>unit <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>create ()</code> creates an unbound socket</p></div></div><div class="odoc-spec"><div class="spec value" id="val-bind" class="anchored"><a href="#val-bind" class="anchor"></a><code><span><span class="keyword">val</span> bind : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-sockaddr">sockaddr</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>bind socket sockaddr</code> binds <code>socket</code> to <code>sockaddr</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-listen" class="anchored"><a href="#val-listen" class="anchor"></a><code><span><span class="keyword">val</span> listen : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>listen socket queue_length</code> sets the socket to listening mode with the given maximum queue length</p></div></div><div class="odoc-spec"><div class="spec value" id="val-accept" class="anchored"><a href="#val-accept" class="anchor"></a><code><span><span class="keyword">val</span> accept : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a> * <a href="#type-sockaddr">sockaddr</a></span></code></div><div class="spec-doc"><p><code>accept fd</code> accepts a single connection</p></div></div><div class="odoc-spec"><div class="spec value" id="val-connect" class="anchored"><a href="#val-connect" class="anchor"></a><code><span><span class="keyword">val</span> connect : <span>?timeout_ms:int <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-sockaddr">sockaddr</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>connect ?timeout_ms fd sockaddr</code> connects to a remote socket. On Windows the raw connect call can block forever if the server is not running when the call is executed (even if the server starts up afterwards) there is a default timeout of 300ms. On timeout this will raise <code>Unix_error(Unix.ETIMEDOUT)</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-writev" class="anchored"><a href="#val-writev" class="anchor"></a><code><span><span class="keyword">val</span> writev : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="xref-unresolved">Cstruct</span>.t list</span> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p>Write a list of buffers</p></div></div><div class="odoc-spec"><div class="spec value" id="val-read_into" class="anchored"><a href="#val-read_into" class="anchor"></a><code><span><span class="keyword">val</span> read_into : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p>Read into a buffer, returning the number of bytes written</p></div></div><div class="odoc-spec"><div class="spec value" id="val-shutdown_read" class="anchored"><a href="#val-shutdown_read" class="anchor"></a><code><span><span class="keyword">val</span> shutdown_read : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Close the read half of the connection</p></div></div><div class="odoc-spec"><div class="spec value" id="val-shutdown_write" class="anchored"><a href="#val-shutdown_write" class="anchor"></a><code><span><span class="keyword">val</span> shutdown_write : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Close the write half of the connection</p></div></div><div class="odoc-spec"><div class="spec value" id="val-close" class="anchored"><a href="#val-close" class="anchor"></a><code><span><span class="keyword">val</span> close : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Close both halves of the connection</p></div></div></details></div></div></body></html>