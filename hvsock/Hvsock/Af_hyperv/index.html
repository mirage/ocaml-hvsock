<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Af_hyperv (hvsock.Hvsock.Af_hyperv)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">hvsock</a> &#x00BB; <a href="../index.html">Hvsock</a> &#x00BB; Af_hyperv</nav><header class="odoc-preamble"><h1>Module <code><span>Hvsock.Af_hyperv</span></code></h1><p>Low-level interface to the AF_HYPERV socket family available on Windows kernels.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type" id="type-vmid" class="anchored"><a href="#type-vmid" class="anchor"></a><code><span><span class="keyword">type</span> vmid</span><span> = </span></code><table><tr id="type-vmid.Wildcard" class="anchored"><td class="def variant constructor"><a href="#type-vmid.Wildcard" class="anchor"></a><code><span>| </span><span><span class="constructor">Wildcard</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Any partition</p><span class="comment-delim">*)</span></td></tr><tr id="type-vmid.Children" class="anchored"><td class="def variant constructor"><a href="#type-vmid.Children" class="anchor"></a><code><span>| </span><span><span class="constructor">Children</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Any child partition</p><span class="comment-delim">*)</span></td></tr><tr id="type-vmid.Loopback" class="anchored"><td class="def variant constructor"><a href="#type-vmid.Loopback" class="anchor"></a><code><span>| </span><span><span class="constructor">Loopback</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>The same partition</p><span class="comment-delim">*)</span></td></tr><tr id="type-vmid.Parent" class="anchored"><td class="def variant constructor"><a href="#type-vmid.Parent" class="anchor"></a><code><span>| </span><span><span class="constructor">Parent</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>The parent partition</p><span class="comment-delim">*)</span></td></tr><tr id="type-vmid.Id" class="anchored"><td class="def variant constructor"><a href="#type-vmid.Id" class="anchor"></a><code><span>| </span><span><span class="constructor">Id</span> <span class="keyword">of</span> <span class="xref-unresolved">Uuidm</span>.t</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>A specific VM id</p><span class="comment-delim">*)</span></td></tr></table></div><div class="spec-doc"><p>A vmid identifies a VM, also known as a partition</p></div></div><div class="odoc-spec"><div class="spec value" id="val-string_of_vmid" class="anchored"><a href="#val-string_of_vmid" class="anchor"></a><code><span><span class="keyword">val</span> string_of_vmid : <span><a href="#type-vmid">vmid</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-serviceid" class="anchored"><a href="#type-serviceid" class="anchor"></a><code><span><span class="keyword">type</span> serviceid</span><span> = string</span></code></div><div class="spec-doc"><p>A serviceid identifies a service (like a port number)</p></div></div><div class="odoc-spec"><div class="spec type" id="type-sockaddr" class="anchored"><a href="#type-sockaddr" class="anchor"></a><code><span><span class="keyword">type</span> sockaddr</span><span> = </span><span>{</span></code><table><tr id="type-sockaddr.vmid" class="anchored"><td class="def record field"><a href="#type-sockaddr.vmid" class="anchor"></a><code><span>vmid : <a href="#type-vmid">vmid</a>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>identifies a partition</p><span class="comment-delim">*)</span></td></tr><tr id="type-sockaddr.serviceid" class="anchored"><td class="def record field"><a href="#type-sockaddr.serviceid" class="anchor"></a><code><span>serviceid : <a href="#type-serviceid">serviceid</a>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>identifies a service</p><span class="comment-delim">*)</span></td></tr></table><code><span>}</span></code></div><div class="spec-doc"><p>An AF_HVSOCK socket address</p></div></div><div class="odoc-include"><details open="open"><summary class="spec include"><code><span><span class="keyword">include</span> <a href="../Af_common/module-type-S/index.html">Af_common.S</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="../Af_common/module-type-S/index.html#type-sockaddr">sockaddr</a> := <a href="#type-sockaddr">sockaddr</a></span> <span class="keyword">and</span> <span><span class="keyword">type</span> <a href="../Af_common/module-type-S/index.html#type-t">t</a> = <span class="xref-unresolved">Unix</span>.file_descr</span></span></code></summary><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span><span> = <span class="xref-unresolved">Unix</span>.file_descr</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-string_of_sockaddr" class="anchored"><a href="#val-string_of_sockaddr" class="anchor"></a><code><span><span class="keyword">val</span> string_of_sockaddr : <span><a href="#type-sockaddr">sockaddr</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-create" class="anchored"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : <span>unit <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>create ()</code> creates an unbound socket</p></div></div><div class="odoc-spec"><div class="spec value" id="val-bind" class="anchored"><a href="#val-bind" class="anchor"></a><code><span><span class="keyword">val</span> bind : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-sockaddr">sockaddr</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>bind socket sockaddr</code> binds <code>socket</code> to <code>sockaddr</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-listen" class="anchored"><a href="#val-listen" class="anchor"></a><code><span><span class="keyword">val</span> listen : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>listen socket queue_length</code> sets the socket to listening mode with the given maximum queue length</p></div></div><div class="odoc-spec"><div class="spec value" id="val-accept" class="anchored"><a href="#val-accept" class="anchor"></a><code><span><span class="keyword">val</span> accept : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a> * <a href="#type-sockaddr">sockaddr</a></span></code></div><div class="spec-doc"><p><code>accept fd</code> accepts a single connection</p></div></div><div class="odoc-spec"><div class="spec value" id="val-connect" class="anchored"><a href="#val-connect" class="anchor"></a><code><span><span class="keyword">val</span> connect : <span>?timeout_ms:int <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-sockaddr">sockaddr</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>connect ?timeout_ms fd sockaddr</code> connects to a remote socket. On Windows the raw connect call can block forever if the server is not running when the call is executed (even if the server starts up afterwards) there is a default timeout of 300ms. On timeout this will raise <code>Unix_error(Unix.ETIMEDOUT)</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-writev" class="anchored"><a href="#val-writev" class="anchor"></a><code><span><span class="keyword">val</span> writev : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="xref-unresolved">Cstruct</span>.t list</span> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p>Write a list of buffers</p></div></div><div class="odoc-spec"><div class="spec value" id="val-read_into" class="anchored"><a href="#val-read_into" class="anchor"></a><code><span><span class="keyword">val</span> read_into : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p>Read into a buffer, returning the number of bytes written</p></div></div><div class="odoc-spec"><div class="spec value" id="val-shutdown_read" class="anchored"><a href="#val-shutdown_read" class="anchor"></a><code><span><span class="keyword">val</span> shutdown_read : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Close the read half of the connection</p></div></div><div class="odoc-spec"><div class="spec value" id="val-shutdown_write" class="anchored"><a href="#val-shutdown_write" class="anchor"></a><code><span><span class="keyword">val</span> shutdown_write : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Close the write half of the connection</p></div></div><div class="odoc-spec"><div class="spec value" id="val-close" class="anchored"><a href="#val-close" class="anchor"></a><code><span><span class="keyword">val</span> close : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Close both halves of the connection</p></div></div></details></div><div class="odoc-spec"><div class="spec value" id="val-vmid_of_name" class="anchored"><a href="#val-vmid_of_name" class="anchor"></a><code><span><span class="keyword">val</span> vmid_of_name : <span>string <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Uuidm</span>.t</span></code></div><div class="spec-doc"><p>Look up a vmid given a VM's human-readable name. This function requires Administrator privileges.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-register_serviceid" class="anchored"><a href="#val-register_serviceid" class="anchor"></a><code><span><span class="keyword">val</span> register_serviceid : <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Register the serviceid in the registry. This function requires Administrator privileges.</p></div></div></div></body></html>